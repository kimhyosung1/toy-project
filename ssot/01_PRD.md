# PRD (Product Requirements Document)

## NestJS 마이크로서비스 스켈레톤 프로젝트

### 📋 프로젝트 개요

**프로젝트명**: NestJS 마이크로서비스 스켈레톤
**프로젝트 성격**: 즉시 사용 가능한 완성도 높은 MSA 템플릿
**버전**: 0.0.1
**작성일**: 2024년
**아키텍처**: MSA (Microservice Architecture)
**기술 스택**: NestJS v11, TypeScript v5.1.3, MySQL, Redis
**런타임**: Node.js v22 (LTS)
**컴파일러**: SWC (15.6% 성능 향상)
**패키지 매니저**: pnpm v8

### 🎯 프로젝트 목적

**완성도 높은 NestJS 마이크로서비스 스켈레톤 제공**

- 기능만 추가하면 바로 프로덕션에 사용할 수 있는 완성된 아키텍처
- 게시판 기능을 예시로 구현된 실제 동작하는 MSA 시스템
- 새로운 프로젝트의 기반 템플릿으로 활용 가능

### 🔧 핵심 혁신 기술

- **🚀 완전 자동화된 응답 검증/변환 시스템**: `@CheckResponseWithType` 데코레이터 기반
- **🛡️ 3단계 에러 방어 시스템**: 안전한 JSON 직렬화 및 예외 처리
- **🔄 Enhanced DB Sync System**: 완전 자동화된 Entity/Repository 생성
- **⚡ SWC 컴파일러**: 15.6% 성능 향상

### 👥 대상 사용자

**주요 타겟**:

- **NestJS 개발자**: 마이크로서비스 아키텍처 학습 및 프로젝트 기반 구축
- **백엔드 아키텍트**: MSA 설계 패턴 및 베스트 프랙티스 참조
- **스타트업/개발팀**: 빠른 프로토타이핑 및 MVP 개발

**부차적 사용자**:

- 익명으로 의견을 공유하고 싶은 사용자 (예시 기능)
- 게시판 관리자 (예시 기능)

### 🔧 핵심 기능 요구사항

> **참고**: 아래 기능들은 스켈레톤 프로젝트의 **예시 구현**입니다. 실제 프로젝트에서는 이를 참고하여 필요한 기능으로 대체할 수 있습니다.

#### 1. 게시판 기능 (예시 구현)

**1.1 게시글 관리**

- ✅ 게시글 작성 (제목, 내용, 작성자명, 비밀번호)
- ✅ 게시글 조회 (페이징 지원)
- ✅ 게시글 검색 (제목, 작성자명 기준)
- ✅ 게시글 수정 (비밀번호 인증 필요)
- ✅ 게시글 삭제 (비밀번호 인증 필요)

**1.2 댓글 시스템**

- ✅ 댓글 작성 (내용, 작성자명)
- ✅ 대댓글 작성 (계층형 구조)
- ✅ 댓글 목록 조회 (페이징 지원)

#### 2. 알림 시스템

**2.1 기본 알림**

- ✅ 슬랙 알림 기능
- ✅ 센트리 에러 리포팅
- ✅ 이메일 알림 기능

> **참고**: 키워드 알림 기능은 시스템 단순화를 위해 제거되었습니다.

### 🏗️ 시스템 아키텍처

#### 마이크로서비스 구성 (현재 운영 중)

1. **Gateway Service** (Port: 3000)
   - API Gateway 역할
   - 외부 요청 라우팅
   - Swagger API 문서 제공

2. **Board Service** (Port: 3001)
   - 게시글/댓글 CRUD
   - 비밀번호 암호화 (bcrypt)
   - 자동화된 응답 검증/변환

3. **Notification Service** (Port: 3002)
   - 알림 처리 서비스
   - 다양한 알림 채널 지원 (Slack, Email, Sentry)

4. **Scheduler Service** (Port: 3004)
   - 정기 작업 실행
   - 시스템 유지보수 작업
   - 자동화된 배치 처리

#### 통신 방식

- **TCP 프로토콜** 기반 마이크로서비스 간 통신
- **Redis Queue** 를 통한 비동기 처리

### 📊 데이터 모델

#### 주요 엔티티

1. **BoardEntity** (tb_board)
   - 게시글 정보 저장
   - 비밀번호 해시 저장

2. **CommentEntity** (tb_comment)
   - 댓글 및 대댓글 저장
   - 계층형 구조 (parent_id)

3. **KeywordNotificationEntity** (tb_keyword_notification)
   - 사용자별 알림 키워드 저장
   - author + keyword 유니크 제약

### 🔒 보안 요구사항

- 게시글 비밀번호 bcrypt 해시 저장
- SQL Injection 방지 (TypeORM 사용)
- XSS 방지 (class-validator 사용)

### 🚀 성능 요구사항

- 게시글 목록 조회 응답시간: < 200ms
- 동시 사용자 100명 지원
- 페이징을 통한 대용량 데이터 처리

### 📈 현재 확장성 구현

- 마이크로서비스 아키텍처로 서비스 분리 완료
- Redis Queue를 통한 비동기 처리 구현
- 데이터베이스 인덱스 최적화 적용

### 🧪 테스트 요구사항

- 단위 테스트 (Jest)
- E2E 테스트
- API 문서 자동 생성 (Swagger)

### 🎯 현재 구현 완료 상태

#### 완료된 핵심 기능

- ✅ **게시판 시스템**: 작성, 조회, 수정, 삭제 완료
- ✅ **댓글 시스템**: 댓글, 대댓글 계층형 구조 완료
- ✅ **알림 시스템**: 키워드 기반 알림 처리 완료
- ✅ **스케줄링**: Cron 기반 배치 작업 완료
- ✅ **자동화 시스템**: 응답 검증/변환 완료
- ✅ **Docker 환경**: 완전한 컨테이너화 완료

#### 운영 중인 서비스

- **Gateway Service**: HTTP API 제공 및 라우팅
- **Board Service**: 게시판 비즈니스 로직 처리
- **Notification Service**: 알림 처리 및 Queue 관리
- **Scheduler Service**: 스케줄링 및 배치 작업
