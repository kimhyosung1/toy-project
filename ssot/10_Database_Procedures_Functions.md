# ğŸ“‹ Database Procedures & Functions ì •ì±…

## ğŸ¯ ê°œìš”

ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ í”„ë¡œì‹œì €ì™€ í•¨ìˆ˜ì˜ **ìë™ ì¶”ì¶œ, ë¬¸ì„œí™”, ê´€ë¦¬ ì •ì±…**ì„ ì •ì˜í•©ë‹ˆë‹¤.

## ğŸ“ íŒŒì¼ êµ¬ì¡°

```
libs/database/src/procedures/
â”œâ”€â”€ procedures/          # ì €ì¥ í”„ë¡œì‹œì € SQL íŒŒì¼ë“¤
â”œâ”€â”€ functions/           # í•¨ìˆ˜ SQL íŒŒì¼ë“¤
â””â”€â”€ *.sql               # ê°œë³„ í”„ë¡œì‹œì €/í•¨ìˆ˜ íŒŒì¼ë“¤
```

## ğŸ”„ ìë™ ìƒì„± ì •ì±…

### íŒŒì¼ ëª…ëª… ê·œì¹™

- **í”„ë¡œì‹œì €**: `{procedure_name}.sql`
- **í•¨ìˆ˜**: `{function_name}.sql`
- **ëª¨ë‘ ì†Œë¬¸ì**ë¡œ ìƒì„±

### íŒŒì¼ ë‚´ìš© êµ¬ì¡°

```sql
-- ================================================================
-- PROCEDURE: procedure_name
-- ================================================================
--
-- Description: í”„ë¡œì‹œì € ì„¤ëª…
--
-- Parameters:
--   IN param1 VARCHAR(100)
--   OUT param2 INT
--
-- Created: 2025-09-13T08:58:50.000Z
-- Modified: 2025-09-13T08:58:50.000Z
-- Environment: dev
-- Database: public
--
-- Generated by: Enhanced DB Schema Analyzer
-- ================================================================

DELIMITER $$

CREATE PROCEDURE `procedure_name`(...)
BEGIN
    -- í”„ë¡œì‹œì € ë³¸ë¬¸
END$$

DELIMITER ;
```

## ğŸ“š ë¬¸ì„œ ìƒì„± ì •ì±…

### âŒ ì œê±°ëœ ë¬¸ì„œë“¤

ë‹¤ìŒ ë¬¸ì„œë“¤ì€ **SSOT ì •ì±…ì— ë”°ë¼ ì œê±°**ë©ë‹ˆë‹¤:

- `libs/database/src/procedures/README.md`
- `libs/database/src/procedures/docs/index.md`
- `libs/database/src/procedures/docs/procedures.md`
- `libs/database/src/procedures/docs/functions.md`

### âœ… í†µí•© ë¬¸ì„œ ì •ì±…

- **ëª¨ë“  ë¬¸ì„œëŠ” SSOT í´ë”ì—ì„œ ê´€ë¦¬**
- **ì‹¤ì œ SQL íŒŒì¼ë§Œ** `libs/database/src/procedures/`ì— ë³´ê´€
- **ë¬¸ì„œì™€ ì •ì±…ì€ SSOTì—ì„œ ì¤‘ì•™ ê´€ë¦¬**

## ğŸš€ ì‚¬ìš©ë²•

### í”„ë¡œì‹œì € í˜¸ì¶œ

```sql
CALL procedure_name(param1, param2);
```

### í•¨ìˆ˜ ì‚¬ìš©

```sql
SELECT function_name(param1) AS result FROM table_name;
```

### íŒŒì¼ ì„í¬íŠ¸

```bash
# ëª¨ë“  í”„ë¡œì‹œì € ì„í¬íŠ¸
mysql -u username -p database_name < libs/database/src/procedures/procedures/*.sql

# íŠ¹ì • í”„ë¡œì‹œì € ì„í¬íŠ¸
mysql -u username -p database_name < libs/database/src/procedures/procedure_name.sql
```

## ğŸ”§ ì¬ìƒì„± ë°©ë²•

```bash
# DB ë™ê¸°í™” ì‹¤í–‰ (í”„ë¡œì‹œì € í¬í•¨)
npm run db:sync

# í”„ë¡œì‹œì €ë§Œ ìˆ˜ë™ ì¶”ì¶œ
ts-node scripts/db-analyzer/procedure-extractor.ts schema.json
```

## âš ï¸ ì¤‘ìš” ì‚¬í•­

1. **ìë™ ìƒì„±**: ëª¨ë“  íŒŒì¼ì€ DBì—ì„œ ìë™ ì¶”ì¶œë¨
2. **í™˜ê²½ë³„ ê´€ë¦¬**: dev/qa/prod í™˜ê²½ë³„ë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ
3. **ë°±ì—… ê¶Œì¥**: í”„ë¡œë•ì…˜ ì ìš© ì „ ë°˜ë“œì‹œ ë°±ì—…
4. **ì˜ì¡´ì„± ì£¼ì˜**: ì¼ë¶€ í”„ë¡œì‹œì €/í•¨ìˆ˜ëŠ” ì„œë¡œ ì˜ì¡´ê´€ê³„ê°€ ìˆì„ ìˆ˜ ìˆìŒ
5. **ìˆ˜ë™ í¸ì§‘ ê¸ˆì§€**: ìƒì„±ëœ íŒŒì¼ì„ ìˆ˜ë™ìœ¼ë¡œ í¸ì§‘í•˜ì§€ ë§ ê²ƒ

## ğŸ¯ í˜„ì¬ ìƒíƒœ (dev í™˜ê²½)

- **ì €ì¥ í”„ë¡œì‹œì €**: 6ê°œ
- **í•¨ìˆ˜**: 5ê°œ
- **ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: ìë™ ìƒì„± ì‹œì 

### ì£¼ìš” í”„ë¡œì‹œì €/í•¨ìˆ˜ ëª©ë¡

- `generate_keywords` - í‚¤ì›Œë“œ ìƒì„± í”„ë¡œì‹œì €
- `sp_hello_world1~5` - í…ŒìŠ¤íŠ¸ìš© í”„ë¡œì‹œì €ë“¤
- `fn_hello_world1~5` - í…ŒìŠ¤íŠ¸ìš© í•¨ìˆ˜ë“¤

---

> ğŸ“ **ì •ì±… ë¬¸ì„œ**: ì´ ë¬¸ì„œëŠ” SSOT(Single Source of Truth) ì •ì±…ì— ë”°ë¼ ì¤‘ì•™ì—ì„œ ê´€ë¦¬ë©ë‹ˆë‹¤.
